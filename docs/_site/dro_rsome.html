<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link rel="icon" type="image/png"  href="assets/img/favicon.png">
    <title>Robust Stochastic Optimization Made Easy by XiongPengNUS</title>

    <link rel="stylesheet" href="/assets/css/styles.css?v=552f0095bb978cceee79a8fd1480ca4a1ed0c4f7">
    <meta name="viewport" content="width=device-width">

    <!-- Place this tag in your head or just before your close body tag. -->
    <script async defer src="https://buttons.github.io/buttons.js"></script>
  </head>
  <body>
    <div class="wrapper">
      <header>

        
          <img src="/rso_left.png" alt="Logo" width=310/>
        

        <!-- <h2>Robust Stochastic Optimization Made Easy</h2> -->

        <table>
          <tr>
          <td><a class="github-button" href="https://github.com/XiongPengNUS/road" data-show-count="true" aria-label="Star XiongPengNUS/road on GitHub">Star</a></td>
          <td><a class="github-button" href="https://github.com/XiongPengNUS/road/subscription" data-show-count="true" aria-label="Watch XiongPengNUS/road on GitHub">Watch</a></td>
          <td><a class="github-button" href="https://github.com/XiongPengNUS/road/fork" data-show-count="true" aria-label="Fork XiongPengNUS/road on GitHub">Fork</a></td>
          </tr>
        </table>

        <table>
          
            
              <tr><th><a href="/">Home</a></th></tr>
            
          
            
              <tr><th><a href="/user_guide">User Guide</a></th></tr>
            
          
            
              <tr><th><a href="/examples">Examples</a></th></tr>
            
          
            
              <tr><th><a href="/about">About</a></th></tr>
            
          
        </table>

        
          <ul>
            <li><a href="https://github.com/XiongPengNUS/rsome/zipball/gh-pages">Download <strong>ZIP File</strong></a></li>
            <li><a href="https://github.com/XiongPengNUS/rsome/tarball/gh-pages">Download <strong>TAR Ball</strong></a></li>
            <li><a href="https://github.com/XiongPengNUS/rsome">View On <strong>GitHub</strong></a></li>
          </ul>
        

      </header>
      <section>

      <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>

<h1 id="rsome-for-distributionally-robust-optimization">RSOME for Distributionally Robust Optimization</h1>

<h2 id="the-general-formulation-for-distributionally-robust-optimization-models-">The General Formulation for Distributionally Robust Optimization Models <a name="section3.1"></a></h2>

<p>The RSOME package supports optimization models that fit the general formulation below</p>

\[\begin{align}
\min ~~ &amp;\sup\limits_{\mathbb{P}\in\mathcal{F}_0} \mathbb{E}_{\mathbb{P}} \left\{\pmb{a}_0^{\top}(\tilde{s}, \tilde{\pmb{z}})\pmb{x}(\tilde{s}) + \pmb{b}_0^{\top}\pmb{y}(\tilde{s}, \tilde{\pmb{z}}) + c_0(\tilde{s}, \tilde{\pmb{z}})\right\} &amp;&amp;\\
\text{s.t.} ~~ &amp;\max\limits_{s\in[S], \pmb{z}\in\mathcal{Z}_{ms}}\left\{\pmb{a}_m^{\top}(s, \pmb{z})\pmb{x}(s) + \pmb{b}_m^{\top}\pmb{y}(s, \pmb{z}) + c_m(s, \pmb{z})\right\} \leq 0, &amp;&amp; \forall m\in \mathcal{M}_1 \\
&amp; \sup\limits_{\mathbb{P}\in\mathcal{F}_m}\mathbb{E}_{\mathbb{P}}\left\{\pmb{a}_m^{\top}(\tilde{s}, \tilde{\pmb{z}})\pmb{x}(\tilde{s}) + \pmb{b}_m^{\top}\pmb{y}(\tilde{s}, \tilde{\pmb{z}}) + c_m(\tilde{s}, \tilde{\pmb{z}})\right\} \leq 0, &amp;&amp; \forall m\in \mathcal{M}_2 \\
&amp; x_i \in \mathcal{A}\left(\mathcal{C}_x^i\right) &amp;&amp; \forall i \in [I_x] \\
&amp; y_n \in \overline{\mathcal{A}}\left(\mathcal{C}_y^n, \mathcal{J}_y^n\right) &amp;&amp; \forall n \in [I_y] \\
&amp; \pmb{x}(s) \in \mathcal{X}_s &amp;&amp; s \in [S]. \\
\end{align}\]

<p>Here, parameters of proper dimensions,</p>

\[\begin{align}
&amp;\pmb{a}_m(s,\pmb{z}) := \pmb{a}_{ms}^0 + \sum\limits_{j\in[J]}\pmb{a}_{ms}^jz_j \\
&amp;\pmb{b}_m(s) := \pmb{b}_{ms}\\
&amp;c_m(\pmb{z}) := c_{ms}^0 + \sum\limits_{j\in[J]}c_{ms}^jz_j
\end{align}\]

<p>are defined similarly as in the case of <a href="ro_rsome#section2.1">RSOME for robust optimization</a> and \(\mathcal{X}_s\) is an second-order conic (SOC) or exponential conic (EC)representable feasible set of a decision \(\pmb{x}(s)\) in the scenario \(x\). Constraints indexed by \(m\in\mathcal{M}_1\) are satisfied under the worst-case realization, just like those introduced in <a href="ro_rsome#section2.1">RSOME for robust optimization</a>. Another set of constraints indexed by \(m\in\mathcal{M}_2\) are satisfied with regard to the worst-case expectation overall all possible distributions defined by an ambiguity set \(\mathcal{F}_m\) in the general form introduced in <a href="#ref2">Chen et al. (2020)</a>:</p>

\[\begin{align}
\mathcal{F}_m = \left\{
\mathbb{P}\in\mathcal{P}_0\left(\mathbb{R}^{J}\times[S]\right)
~\left|~
\begin{array}{ll}
\left(\tilde{\pmb{z}}, \tilde{s}\right) \sim \mathbb{P} &amp; \\
\mathbb{E}_{\mathbb{P}}[\tilde{\pmb{z}}|\tilde{s}\in\mathcal{E}_{km}] \in \mathcal{Q}_{km} &amp; \forall k \in [K] \\
\mathbb{P}[\tilde{\pmb{z}}\in \mathcal{Z}_{sm}| \tilde{s}=s]=1 &amp; \forall s \in [S] \\
\mathbb{P}[\tilde{s}=s] = p_s &amp; \forall s \in [S] \\
\text{for some } \pmb{p} \in \mathcal{P}_m &amp;
\end{array}
\right.
\right\},~~~
\forall m \in \mathcal{M}_2
\end{align}.\]

<p>Here for each constraint indexed by \(m\in\mathcal{M}_2\),</p>

<ol>
  <li>The conditional expectation of \(\tilde{\pmb{z}}\) over events (defined as subsets of scenarios and denoted by \(\mathcal{E}_{km}\) are known to reside in an SOC or EC representable set \(\mathcal{Q}_{km}\);</li>
  <li>The support of \(\tilde{\pmb{z}}\) in each scenario \(s\in[S]\) is specified to be another SOC or EC representable set \(\mathcal{Z}_{sm}\);</li>
  <li>Probabilities of scenarios, collectively denoted by a vector \(\pmb{p}\), are constrained by a third SOC or EC representable subset \(\mathcal{P}_m\subseteq\left\{\pmb{p}\in \mathbb{R}_{++}^S \left| \pmb{e}^{\top}\pmb{p}=1 \right. \right\}\) in the probability simplex.</li>
</ol>

<p>Dynamics of decision-making is captured by the event-wise recourse adaptation for wait-and-see decisions of two types–the <i>event-wise static adaptation</i> denoted by \(\mathcal{A}(C)\) as well as the <i>event-wise affine adaptation</i> denoted by \(\overline{\mathcal{A}}(\mathcal{C}, \mathcal{J})\). In particular, given a fixed number of \(S\) scenarios and a
partition \(\mathcal{C}\) of these scenarios (<i>i.e.</i>, a collection of mutually exclusive and collectively exhaustive
events), the event-wise recourse adaptation is formally defined as follows:</p>

\[\begin{align}
&amp;\mathcal{A}\left(\mathcal{C}\right) = \left\{
x: [S] \mapsto \mathbb{R} ~\left|~
\begin{array}{l}
x(s)=x^{\mathcal{E}}, \mathcal{E}=\mathcal{H}_{\mathcal{C}}(s) \\
\text{for some } x^{\mathcal{E}} \in \mathbb{R}
\end{array}
\right.
\right\}, \\
&amp;\overline{\mathcal{A}}\left(\mathcal{C}, \mathcal{J}\right) = \left\{
y: [S]\times\mathbb{R}^{J} \mapsto \mathbb{R}
~\left|~
\begin{array}{ll}
y(s, \pmb{z}) = y^0(s) + \sum\limits_{j\in\mathcal{J}}y^j(s)z_j &amp; \\
\text{for some }y^0(s), y^j(s) \in \mathcal{A}\left(\mathcal{C}\right) &amp; j\in\mathcal{J}
\end{array}
\right.
\right\}
\end{align}.\]

<p>Here, \(\mathcal{H}_{\mathcal{C}}: [S] \mapsto \mathcal{C}\) is a function such that \(\mathcal{H}_{\mathcal{C}}= \mathcal{E}\) maps the scenario \(s\) to the only event \(\mathcal{E}\) in \(\mathcal{C}\) that contains \(s\), and \(\mathcal{J} \subseteq [J]\) is an index subset of random components \(\tilde{z}_1\),…, \(\tilde{z}_J\) that the affine adaptation depends on. In the remaining part of the guide, we will introduce the RSOME code for specifying the event-wise ambiguity set and recourse adaptation rules.</p>

<h2 id="introduction-to-the-rsomedro-environment-">Introduction to the <code class="language-plaintext highlighter-rouge">rsome.dro</code> Environment <a name="section3.2"></a></h2>

<p>In general, the <code class="language-plaintext highlighter-rouge">rsome.dro</code> modeling environment is very similar to <code class="language-plaintext highlighter-rouge">rsome.ro</code> discussed in the section <a href="get_start#section1.2">Introduction to the <code>rsome.ro</code> Environment</a>, so almost all array operations, indexing and slicing syntax could be applied to <code class="language-plaintext highlighter-rouge">dro</code> models. The unique features of the <code class="language-plaintext highlighter-rouge">dro</code> model mainly come from the scenario-representation of uncertainties and a different way of specifying the event-wise adaptation of decision variables.</p>

<h3 id="models">Models</h3>
<p>Similar to the <code class="language-plaintext highlighter-rouge">rsome.ro</code> modeling environment, the <code class="language-plaintext highlighter-rouge">dro</code> models are all defined upon <code class="language-plaintext highlighter-rouge">Model</code> type objects, which are created by the constructor <code class="language-plaintext highlighter-rouge">Model()</code> imported from the sub-package <code class="language-plaintext highlighter-rouge">rsome.dro</code>.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>class Model(builtins.object)
 |  Model(scens=1, name=None)
 |  
 |  Returns a model object with the given number of scenarios.
 |  
 |  Parameters
 |  ----------
 |  scens : int or array-like objects
 |      The number of scenarios, if it is an integer. It could also be
 |      an array of scenario indices.
 |  name : str
 |      Name of the model
 |  
 |  Returns
 |  -------
 |  model : rsome.dro.Model
 |      A model object
</code></pre></div></div>

<p>It can be seen that the <code class="language-plaintext highlighter-rouge">dro</code> models are different from the <code class="language-plaintext highlighter-rouge">ro</code> models in the first argument <code class="language-plaintext highlighter-rouge">scens</code>, which specifies the scenario-representation of uncertainties. The <code class="language-plaintext highlighter-rouge">scens</code> argument can be specified as an integer, indicating the number of scenarios, or an array of scenario indices, as shown by the following sample code.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">rsome</span> <span class="kn">import</span> <span class="n">dro</span>

<span class="n">model1</span> <span class="o">=</span> <span class="n">dro</span><span class="p">.</span><span class="n">Model</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>       <span class="c1"># a DRO model with 5 scenarios
</span>
<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s">'sunny'</span><span class="p">,</span> <span class="s">'cloudy'</span><span class="p">,</span> <span class="s">'rainy'</span><span class="p">,</span> <span class="s">'windy'</span><span class="p">,</span> <span class="s">'snowy'</span><span class="p">]</span>
<span class="n">model2</span> <span class="o">=</span> <span class="n">dro</span><span class="p">.</span><span class="n">Model</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>  <span class="c1"># a DRO model with 5 scenarios given by a list.
</span></code></pre></div></div>

<h3 id="decision-variables">Decision Variables</h3>

<p>In the general formulation, decision variables \(\pmb{x}(s)\) are event-wise static and \(\pmb{y}(s, \pmb{z})\) are event-wise affinely adaptive. The <code class="language-plaintext highlighter-rouge">dro</code> modeling environment does not differentiate the two in creating these variables. Both types of decision variables are created by the <code class="language-plaintext highlighter-rouge">dvar()</code> method of the model object, with the same syntax as the <code class="language-plaintext highlighter-rouge">rsome.ro</code> models.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>dvar(shape=(1,), vtype='C', name=None) method of rsome.dro.Model instance
    Returns an array of decision variables with the given shape
    and variable type.

    Parameters
    ----------
    shape : int or tuple
        Shape of the variable array.
    vtype : {'C', 'B', 'I'}
        Type of the decision variables. 'C' means continuous; 'B'
        means binary, and 'I" means integer.
    name : str
        Name of the variable array

    Returns
    -------
    new_var : rsome.lp.DecVar
        An array of new decision variables
</code></pre></div></div>

<p>All decision variables are created to be non-adaptive at first. The event-wise and affine adaptation can be then specified by the method <code class="language-plaintext highlighter-rouge">adapt()</code> of the variable object. Details of specifying the adaptive decisions are provided in the section <a href="#section3.3">Event-wise recourse adaptations</a></p>

<h3 id="random-variables">Random Variables</h3>
<p>The syntax of creating random variables for a <code class="language-plaintext highlighter-rouge">dro</code> model is exactly the same as the <code class="language-plaintext highlighter-rouge">ro</code> models. You may refer to the section <a href="ro_rsome#section2.2">Random variables and uncertainty sets</a> for more details.</p>

<p>The <code class="language-plaintext highlighter-rouge">dro</code> model supports the expectation of random variables, so that we could define the expectation sets \(\mathcal{Q}_{km}\) in the ambiguity set \(\mathcal{F}_m\). This is different from <code class="language-plaintext highlighter-rouge">ro</code> models. The expectation is indicated by the <code class="language-plaintext highlighter-rouge">E()</code> function imported from <code class="language-plaintext highlighter-rouge">rsome</code>, as demonstrated by the sample code below.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">rsome</span> <span class="kn">import</span> <span class="n">dro</span>
<span class="kn">from</span> <span class="nn">rsome</span> <span class="kn">import</span> <span class="n">E</span>     <span class="c1"># import E as the expectation operator
</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">dro</span><span class="p">.</span><span class="n">Model</span><span class="p">()</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">rvar</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>  <span class="c1"># 3x5 random variables as a 2D array
</span>
<span class="n">E</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">1</span>               <span class="c1"># E(z) is smaller than or equal to zero
</span><span class="n">E</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="o">-</span><span class="mi">1</span>              <span class="c1"># E(z) is larger than or equal to -1
</span><span class="n">E</span><span class="p">(</span><span class="n">z</span><span class="p">).</span><span class="nb">sum</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span>         <span class="c1"># sum of E(z) is zero
</span></code></pre></div></div>

<h2 id="event-wise-ambiguity-set-">Event-wise Ambiguity Set <a name="section3.3"></a></h2>

<h3 id="create-an-ambiguity-set">Create an Ambiguity Set</h3>

<p>Ambiguity sets \(\mathcal{F}_m\) of a <code class="language-plaintext highlighter-rouge">dro</code> model can be created by the <code class="language-plaintext highlighter-rouge">ambiguity()</code> method. The associated scenario indices of the ambiguity set can be accessed by the <code class="language-plaintext highlighter-rouge">s</code> attribute of the ambiguity set object, as shown by the following sample code.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">rsome</span> <span class="kn">import</span> <span class="n">dro</span>

<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s">'sunny'</span><span class="p">,</span> <span class="s">'cloudy'</span><span class="p">,</span> <span class="s">'rainy'</span><span class="p">,</span> <span class="s">'windy'</span><span class="p">,</span> <span class="s">'snowy'</span><span class="p">]</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">dro</span><span class="p">.</span><span class="n">Model</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>     <span class="c1"># create a model with 5 scenarios
</span>
<span class="n">fset</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">ambiguity</span><span class="p">()</span>      <span class="c1"># create an ambiguity set of the model
</span><span class="k">print</span><span class="p">(</span><span class="n">fset</span><span class="p">)</span>                   <span class="c1"># print scenarios of the model (ambiguity set)
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Scenario indices:
sunny     0
cloudy    1
rainy     2
windy     3
snowy     4
dtype: int64
</code></pre></div></div>
<p>In the example above, strings in the list <code class="language-plaintext highlighter-rouge">labels</code> become the labels of the scenario indices. If an integer instead of an array is used to specify the <code class="language-plaintext highlighter-rouge">scens</code> argument of the <code class="language-plaintext highlighter-rouge">Model()</code> constructor, then the labels will be the same as the integer values. Similar to the <code class="language-plaintext highlighter-rouge">pandas.Series</code> data structure, labels of the scenario indices could be any hashable data types.</p>

<p>RSOME supports indexing and slicing of the scenarios via either the labels or the integer-positions, as shown by the following code segments.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">fset</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>          <span class="c1"># the third scenario
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Scenario index:
2
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">fset</span><span class="p">[</span><span class="s">'rainy'</span><span class="p">])</span>    <span class="c1"># the third scenario
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Scenario index:
2
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">fset</span><span class="p">[:</span><span class="mi">3</span><span class="p">])</span>         <span class="c1"># the first three scenarios
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Scenario indices:
sunny     0
cloudy    1
rainy     2
dtype: int64
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">fset</span><span class="p">[:</span><span class="s">'rainy'</span><span class="p">])</span>   <span class="c1"># the first three scenarios
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Scenario indices:
sunny     0
cloudy    1
rainy     2
dtype: int64
</code></pre></div></div>

<p>RSOME is also consistent with the <code class="language-plaintext highlighter-rouge">pandas.Sereis</code> data type in using the <code class="language-plaintext highlighter-rouge">iloc</code> and <code class="language-plaintext highlighter-rouge">loc</code> indexers for accessing label-based or integer-position based indices.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">fset</span><span class="p">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">2</span><span class="p">])</span>            <span class="c1"># the first two scenarios via the iloc[] indexer
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Scenario indices:
sunny     0
cloudy    1
dtype: int64
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">fset</span><span class="p">.</span><span class="n">loc</span><span class="p">[:</span><span class="s">'cloudy'</span><span class="p">])</span>      <span class="c1"># the first two scenarios via the loc[] indexer
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Scenario indices:
sunny     0
cloudy    1
dtype: int64
</code></pre></div></div>

<p>The indices of the scenarios are crucial in defining components of the ambiguity set, such as sets \(\mathcal{Q}_{km}\), and \(\mathcal{Z}_{sm}\), which will be discussed next.</p>

<h3 id="mathcalq_km-as-the-support-of-conditional-expectations">\(\mathcal{Q}_{km}\) as the Support of Conditional Expectations</h3>

<p>According to the formulation of the ambiguity set \(\mathcal{F}_m\) presented in the section <a href="#section3.1">The general formulation for distributionally robust optimization models</a>, the SOC or EC representable set \(\mathcal{Q}_{km}\) is defined as the support of the conditional expectation of random variables under the event \(\mathcal{E}_k\), which is a collection of selected scenarios. In the RSOME package, such a collection of scenarios can be specified by the indexing or slicing of the ambiguity set object, and constraints of the \(\mathcal{Q}_{km}\) are defined by the <code class="language-plaintext highlighter-rouge">exptset()</code> method of the ambiguity set object. The help information of the <code class="language-plaintext highlighter-rouge">exptset()</code> method is given below.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>exptset(*args) method of rsome.dro.Ambiguity instance
    Specify the uncertainty set of the expected values of random
    variables for an ambiguity set.

    Parameters
    ----------
    args : tuple
        Constraints or collections of constraints as iterable type of
        objects, used for defining the feasible region of the uncertainty
        set of expectations.

    Notes
    -----
    RSOME leaves the uncertainty set of expectations unspecified if the
    input argument is an empty iterable object.
</code></pre></div></div>

<p>Take the supports of conditional expectations below, for example,</p>

\[\begin{align}
&amp;\mathbb{E}\left[\tilde{\pmb{z}}|s\in\mathcal{E}_{1}\right] \in \left\{\pmb{z}: \mathbb{R}^3 \left|
\begin{array}{l}
|\pmb{z}| \leq 1 \\
\|\pmb{z}\|_1 \leq 1.5
\end{array}
\right.
\right\}, &amp;&amp; \mathcal{E}_1 = \{\text{sunny}, \text{cloudy}, \text{rainy}, \text{windy}, \text{snowy}\} \\
&amp;\mathbb{E}\left[\tilde{\pmb{z}}|s\in\mathcal{E}_{2}\right] \in \left\{\pmb{z}: \mathbb{R}^3 \left|
\begin{array}
~\pmb{z} = 0
\end{array}
\right.
\right\}, &amp;&amp; \mathcal{E}_2 = \{\text{sunny}, \text{rainy}, \text{snowy}\},
\end{align}\]

<p>where the first event \(\mathcal{E}_1\) is a collection of all scenarios, and the second event \(\mathcal{E}_2\) includes scenarios “sunny”, “rainy”, and “snowy”. The conditional expectation information of the ambiguity set can be specified by the code below.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">rsome</span> <span class="kn">import</span> <span class="n">dro</span>
<span class="kn">from</span> <span class="nn">rsome</span> <span class="kn">import</span> <span class="n">E</span>
<span class="kn">from</span> <span class="nn">rsome</span> <span class="kn">import</span> <span class="n">norm</span>

<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s">'sunny'</span><span class="p">,</span> <span class="s">'cloudy'</span><span class="p">,</span> <span class="s">'rainy'</span><span class="p">,</span> <span class="s">'windy'</span><span class="p">,</span> <span class="s">'snowy'</span><span class="p">]</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">dro</span><span class="p">.</span><span class="n">Model</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">rvar</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

<span class="n">fset</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">ambiguity</span><span class="p">()</span>             <span class="c1"># create an ambiguity set
</span><span class="n">fset</span><span class="p">.</span><span class="n">exptset</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">E</span><span class="p">(</span><span class="n">z</span><span class="p">))</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">,</span>
             <span class="n">norm</span><span class="p">(</span><span class="n">E</span><span class="p">(</span><span class="n">z</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mf">1.5</span><span class="p">)</span>   <span class="c1"># the 1st support of conditional expectations
</span><span class="n">fset</span><span class="p">.</span><span class="n">loc</span><span class="p">[::</span><span class="mi">2</span><span class="p">].</span><span class="n">exptset</span><span class="p">(</span><span class="n">E</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>     <span class="c1"># the 2nd support of conditional expectations
</span></code></pre></div></div>

<p>The ambiguity set <code class="language-plaintext highlighter-rouge">fset</code> itself represents the event \(\mathcal{E}_1\) of all scenarios, and the <code class="language-plaintext highlighter-rouge">loc</code> indexer is used to form the event \(\mathcal{E}_2\) with three scenarios included. Besides <code class="language-plaintext highlighter-rouge">loc</code>, other indexing and slicing expressions described in the previous section can also be used to construct the events for the support sets of the expectations.</p>

<h3 id="mathcalz_sm-as-the-support-of-random-variables">\(\mathcal{Z}_{sm}\) as the Support of Random Variables</h3>

<p>The support \(\mathcal{Z}_{sm}\) of random variables can be specified by the method <code class="language-plaintext highlighter-rouge">suppset()</code> method, and the scenario information of the support can also be specified by the indexing and slicing expressions of the ambiguity set object. The help information of the <code class="language-plaintext highlighter-rouge">suppset()</code> method is given below.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>suppset(*args) method of rsome.dro.Ambiguity instance
    Specify the support set(s) of an ambiguity set.

    Parameters
    ----------
    args : Constraints or iterables
        Constraints or collections of constraints as iterable type of
        objects, used for defining the feasible region of the support set.

    Notes
    -----
    RSOME leaves the support set unspecified if the given argument is
    an empty iterable object.
</code></pre></div></div>

<p>Take the following supports of random variables \(\tilde{\pmb{z}}\in\mathbb{R}^3\) for example,</p>

\[\begin{align}
&amp;\mathbb{P}\left[\tilde{\pmb{z}}\in \left\{
  \left.
  \pmb{z}: \mathbb{R}^3 ~\left|
  \begin{array}{l}
  |\pmb{z}| \leq 1 \\
  \|\pmb{z}\| \leq 1.5
  \end{array}
  \right.
\right\}
\right|
\tilde{s}=s
\right]=1, &amp;\forall s \in \{\text{sunny}, \text{rainy},  \text{snowy}\} \\
&amp;\mathbb{P}\left[\tilde{\pmb{z}}\in \left\{
  \left.
  \pmb{z}: \mathbb{R}^3 \left|
  \begin{array}
  ~\sum\limits_{j=1}^3z_j = 0
  \end{array}
  \right.
\right\}
\right|
\tilde{s}=s
\right]=1, &amp;\forall s \in \{\text{cloudy}, \text{windy}\},
\end{align}\]

<p>the RSOME code for specifying the supports can be written as follows.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">rsome</span> <span class="kn">import</span> <span class="n">dro</span>
<span class="kn">from</span> <span class="nn">rsome</span> <span class="kn">import</span> <span class="n">E</span>
<span class="kn">from</span> <span class="nn">rsome</span> <span class="kn">import</span> <span class="n">norm</span>

<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s">'sunny'</span><span class="p">,</span> <span class="s">'cloudy'</span><span class="p">,</span> <span class="s">'rainy'</span><span class="p">,</span> <span class="s">'windy'</span><span class="p">,</span> <span class="s">'snowy'</span><span class="p">]</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">dro</span><span class="p">.</span><span class="n">Model</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">rvar</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

<span class="n">fset</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">ambiguity</span><span class="p">()</span>
<span class="n">fset</span><span class="p">.</span><span class="n">iloc</span><span class="p">[::</span><span class="mi">2</span><span class="p">].</span><span class="n">suppset</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">,</span>
                       <span class="n">norm</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mf">1.5</span><span class="p">)</span>  <span class="c1"># the support of z in scenarios 0, 2, 4
</span><span class="n">fset</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">].</span><span class="n">suppset</span><span class="p">(</span><span class="n">z</span><span class="p">.</span><span class="nb">sum</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>      <span class="c1"># the support of z in scenarios 1, 3
</span></code></pre></div></div>

<p>Note that a valid ambiguity set must have the support sets for all scenarios to be specified. An error message will be given in solving the model if any of the supports are unspecified. RSOME provides a method called <code class="language-plaintext highlighter-rouge">showevents()</code> to display the specified supports for random variables and their expectations in a data frame, in order to help users check their ambiguity set.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">rsome</span> <span class="kn">import</span> <span class="n">dro</span>
<span class="kn">from</span> <span class="nn">rsome</span> <span class="kn">import</span> <span class="n">E</span>
<span class="kn">from</span> <span class="nn">rsome</span> <span class="kn">import</span> <span class="n">norm</span>

<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s">'sunny'</span><span class="p">,</span> <span class="s">'cloudy'</span><span class="p">,</span> <span class="s">'rainy'</span><span class="p">,</span> <span class="s">'windy'</span><span class="p">,</span> <span class="s">'snowy'</span><span class="p">]</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">dro</span><span class="p">.</span><span class="n">Model</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">rvar</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

<span class="n">fset</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">ambiguity</span><span class="p">()</span>
<span class="n">fset</span><span class="p">.</span><span class="n">iloc</span><span class="p">[::</span><span class="mi">2</span><span class="p">].</span><span class="n">suppset</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">norm</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mf">1.5</span><span class="p">)</span>  
<span class="n">fset</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">].</span><span class="n">suppset</span><span class="p">(</span><span class="n">z</span><span class="p">.</span><span class="nb">sum</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>      
<span class="n">fset</span><span class="p">.</span><span class="n">exptset</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">E</span><span class="p">(</span><span class="n">z</span><span class="p">))</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">norm</span><span class="p">(</span><span class="n">E</span><span class="p">(</span><span class="n">z</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mf">1.5</span><span class="p">)</span>   
<span class="n">fset</span><span class="p">.</span><span class="n">loc</span><span class="p">[::</span><span class="mi">2</span><span class="p">].</span><span class="n">exptset</span><span class="p">(</span><span class="n">E</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>     

<span class="n">fset</span><span class="p">.</span><span class="n">showevents</span><span class="p">()</span>            <span class="c1"># display how the ambiguity set is specified
</span></code></pre></div></div>

<div>
<table border="1" class="dataframe mystyle">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>support</th>
      <th>expectation 0</th>
      <th>expectation 1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>sunny</th>
      <td>defined</td>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <th>cloudy</th>
      <td>defined</td>
      <td>True</td>
      <td>False</td>
    </tr>
    <tr>
      <th>rainy</th>
      <td>defined</td>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <th>windy</th>
      <td>defined</td>
      <td>True</td>
      <td>False</td>
    </tr>
    <tr>
      <th>snowy</th>
      <td>defined</td>
      <td>True</td>
      <td>True</td>
    </tr>
  </tbody>
</table>
</div>

<p>As the example above shows, supports for all scenarios have been defined, and there are two supports defined for the conditional expectations.</p>

<h3 id="mathcalp_m-as-the-support-of-scenario-probabilities">\(\mathcal{P}_m\) as the Support of Scenario Probabilities</h3>

<p>In the event-wise ambiguity set, the support of scenario probabilities can also be specified via calling the method <code class="language-plaintext highlighter-rouge">probset()</code>. The help information of this method is given below.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>probset(*args) method of rsome.dro.Ambiguity instance
    Specify the uncertainty set of the scenario probabilities for an
    ambiguity set.

    Parameters
    ----------
    args : tuple
        Constraints or collections of constraints as iterable type of
        objects, used for defining the feasible region of the uncertainty
        set of scenario probabilities.

    Notes
    -----
    RSOME leaves the uncertainty set of probabilities unspecified if the
    input argument is an empty iterable object.
</code></pre></div></div>

<p>The following sample code specifies an ellipsoidal uncertainty set of the scenario probabilities.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">rsome</span> <span class="kn">import</span> <span class="n">dro</span>
<span class="kn">from</span> <span class="nn">rsome</span> <span class="kn">import</span> <span class="n">norm</span>

<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s">'sunny'</span><span class="p">,</span> <span class="s">'cloudy'</span><span class="p">,</span> <span class="s">'rainy'</span><span class="p">,</span> <span class="s">'windy'</span><span class="p">,</span> <span class="s">'snowy'</span><span class="p">]</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">dro</span><span class="p">.</span><span class="n">Model</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">rvar</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

<span class="n">fset</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">ambiguity</span><span class="p">()</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">p</span>                         <span class="c1"># p is the array of scenario probabilities
</span><span class="n">fset</span><span class="p">.</span><span class="n">probset</span><span class="p">(</span><span class="n">norm</span><span class="p">(</span><span class="n">p</span><span class="o">-</span><span class="mf">0.2</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mf">0.05</span><span class="p">)</span>   <span class="c1"># define the support of the array p
</span></code></pre></div></div>

<p>The scenario probabilities are formatted as a one-dimensional array, which can be accessed via the attribute <code class="language-plaintext highlighter-rouge">p</code> of the model object. Notice that two underlying constraints for probabilities: \(\pmb{p}\geq \pmb{0}\) and \(\pmb{e}^{\top}\pmb{p}=1\), are already integrated in the ambiguity set, so there is no need to specify them in defining the support of scenario probabilities.</p>

<h2 id="event-wise-recourse-adaptations-">Event-wise Recourse Adaptations <a name="section3.4"></a></h2>

<p>Here we introduce how the event-wise static adaptation \(\mathcal{A}(\mathcal{C})\) and the event-wise affine adaptation \(\overline{\mathcal{A}}(\mathcal{C}, \mathcal{J})\) are specified in RSOME. Note that decision variables created in the <code class="language-plaintext highlighter-rouge">rsome.dro</code> modeling environment are initially non-adaptive, in the sense that the event set \(\mathcal{C} = \{[S]\}\) and the dependent set \(\mathcal{J}=\varnothing\). These two sets can be modified by the <code class="language-plaintext highlighter-rouge">adapt()</code> method of the decision variable object for specifying the decision adaptation, as demonstrated by the following sample code.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">rsome</span> <span class="kn">import</span> <span class="n">dro</span>

<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s">'sunny'</span><span class="p">,</span> <span class="s">'cloudy'</span><span class="p">,</span> <span class="s">'rainy'</span><span class="p">,</span> <span class="s">'windy'</span><span class="p">,</span> <span class="s">'snowy'</span><span class="p">]</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">dro</span><span class="p">.</span><span class="n">Model</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">rvar</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">dvar</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

<span class="n">x</span><span class="p">.</span><span class="n">adapt</span><span class="p">(</span><span class="s">'sunny'</span><span class="p">)</span>        <span class="c1"># x adapts to the sunny
</span><span class="n">x</span><span class="p">.</span><span class="n">adapt</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>         <span class="c1"># x adapts to the event of rainy and windy
</span>
<span class="n">x</span><span class="p">[:</span><span class="mi">2</span><span class="p">].</span><span class="n">adapt</span><span class="p">(</span><span class="n">z</span><span class="p">[:</span><span class="mi">2</span><span class="p">])</span>      <span class="c1"># x[:2] is affinely adaptive to z[:2]
</span></code></pre></div></div>

<p>In the code segment above, the scenario partition \(\mathcal{C}\) is specified to have three events: \(\{\text{sunny}\}\), \(\{\text{rainy}, \text{windy}\}\), and collectively the remaining scenarios \(\{\text{cloudy}, \text{snowy}\}\). The decision variable <code class="language-plaintext highlighter-rouge">x[:2]</code> is set to be affinely adaptive to the random variable <code class="language-plaintext highlighter-rouge">z[:2]</code>.</p>

<p>Similar to the linear decision rule defined in the <code class="language-plaintext highlighter-rouge">ro</code> module, coefficients of an event-wise recourse adaptation could be accessed by the <code class="language-plaintext highlighter-rouge">get()</code> method after solving the model, where</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">y.get()</code> returns the constant coefficients of the recourse adaptation. In cases of multiple scenarios, the returned object is a <code class="language-plaintext highlighter-rouge">pandas.Series</code> with the length to be the same as the number of scenarios. Each element of the series is an array that has the same shape as <code class="language-plaintext highlighter-rouge">y</code>.</li>
  <li><code class="language-plaintext highlighter-rouge">y.get(z)</code> returns the linear coefficients of the recourse adaptation. In cases of multiple scenarios, the returned object is a <code class="language-plaintext highlighter-rouge">pandas.Series</code> with the length to be the same as the number of scenarios. Each element of the series is an array, and the shape of the array is <code class="language-plaintext highlighter-rouge">y.shape + z.shape</code>, <i>i.e.</i>, the combination of dimensions of <code class="language-plaintext highlighter-rouge">y</code> and <code class="language-plaintext highlighter-rouge">z</code>.</li>
</ul>

<h2 id="the-worst-case-expectations-">The Worst-Case Expectations <a name="section3.5"></a></h2>

<p>Once the ambiguity sets \(\mathcal{F}_m\) and the recourse adaptation of decision variables are defined, the worst-case expectations in the objective function or constraints can be then specified. The ambiguity set of the objective function can be specified by the <code class="language-plaintext highlighter-rouge">minsup()</code> method, for minimizing, or the <code class="language-plaintext highlighter-rouge">maxinf()</code> method, for maximizing, the objective function involving the worst-case expectations. The documentation of the <code class="language-plaintext highlighter-rouge">minsup()</code> method is given below.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>minsup(obj, ambset) method of rsome.dro.Model instance
    Minimize the worst-case expected objective value over the given
    ambiguity set.

    Parameters
    ----------
    obj
        Objective function involving random variables
    ambset : Ambiguity
        The ambiguity set defined for the worst-case expectation

    Notes
    -----
    The ambiguity set defined for the objective function is considered
    the default ambiguity set for the distributionally robust model.
</code></pre></div></div>

<p>Similar to <code class="language-plaintext highlighter-rouge">ro</code> models, ambiguity sets of constraints indexed by \(m\in\mathcal{M}_2\), concerning the worst-case expectations, can be specified by the <code class="language-plaintext highlighter-rouge">forall()</code> method, and if the ambiguity set of such constraints are unspecified, then by default, the underlying ambiguity set is the same as \(\mathcal{F}_0\) defined for the objective function. As for the worst-case constraints indexed by \(m\in\mathcal{M}_1\), the uncertainty set can also be specified by the <code class="language-plaintext highlighter-rouge">forall()</code> method, and if the uncertainty set is unspecified, such worst-case constraints are defined upon support sets \(\mathcal{Z}_{0s}\) of the default ambiguity set \(\mathcal{F}_0\), for each scenario \(s\in[S]\). The sample code below demonstrates how the worst-case expectations can be formulated in the objective function and constraints.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">rsome</span> <span class="kn">import</span> <span class="n">dro</span>
<span class="kn">from</span> <span class="nn">rsome</span> <span class="kn">import</span> <span class="n">norm</span>
<span class="kn">from</span> <span class="nn">rsome</span> <span class="kn">import</span> <span class="n">E</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">dro</span><span class="p">.</span><span class="n">Model</span><span class="p">()</span>             <span class="c1"># create a model with one scenario
</span><span class="n">z</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">rvar</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">u</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">rvar</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">dvar</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

<span class="n">fset</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">ambiguity</span><span class="p">()</span>        <span class="c1"># create an ambiguity set
</span><span class="n">fset</span><span class="p">.</span><span class="n">suppset</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">u</span><span class="p">,</span> <span class="n">u</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">,</span>
             <span class="n">norm</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mf">1.5</span><span class="p">)</span>
<span class="n">fset</span><span class="p">.</span><span class="n">exptset</span><span class="p">(</span><span class="n">E</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="n">E</span><span class="p">(</span><span class="n">u</span><span class="p">)</span> <span class="o">==</span> <span class="mf">0.5</span><span class="p">)</span>

<span class="n">model</span><span class="p">.</span><span class="n">maxinf</span><span class="p">(</span><span class="n">E</span><span class="p">(</span><span class="n">x</span> <span class="o">@</span> <span class="n">z</span><span class="p">),</span> <span class="n">fset</span><span class="p">)</span>    <span class="c1"># maximize the worst-case expectation over fset
</span>
<span class="n">model</span><span class="p">.</span><span class="n">st</span><span class="p">((</span><span class="n">E</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">z</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">))</span>       <span class="c1"># worst-case expectation over fset
</span><span class="n">model</span><span class="p">.</span><span class="n">st</span><span class="p">(</span><span class="mi">2</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="n">z</span><span class="p">)</span>               <span class="c1"># worst-case over the support of fset
</span></code></pre></div></div>

<h2 id="application-examples-">Application Examples <a name="section3.6"></a></h2>
<h3 id="distributionally-robust-portfolio"><a href="example_dro_portfolio">Distributionally Robust Portfolio</a></h3>
<h3 id="distributionally-robust-portfolio-under-moment-uncertainty"><a href="example_moment_uncertainty_portfolio">Distributionally Robust Portfolio under Moment Uncertainty</a></h3>
<h3 id="distributionally-robust-medical-appointment"><a href="example_dro_mas">Distributionally Robust Medical Appointment</a></h3>
<h3 id="mean-risk-portfolio-optimization-with-a-wasserstein-ambiguity-set"><a href="example_dro_wass_portfolio">Mean-Risk Portfolio Optimization with a Wasserstein Ambiguity Set</a></h3>
<h3 id="robust-satisficing-for-portfolio-optimization"><a href="example_dro_rs_portfolio">Robust Satisficing for Portfolio Optimization</a></h3>
<h3 id="multi-item-newsvendor-problem-with-wasserstein-ambiguity-sets"><a href="example_dro_nv">Multi-Item Newsvendor Problem with Wasserstein Ambiguity Sets</a></h3>
<h3 id="adaptive-distributionally-robust-lot-sizing"><a href="example_dro_ls">Adaptive Distributionally Robust Lot-Sizing</a></h3>
<h3 id="distributionally-robust-vehicle-pre-allocation"><a href="example_dro_vehicle">Distributionally Robust Vehicle Pre-Allocation</a></h3>
<h3 id="multi-stage-inventory-control"><a href="example_dro_inv">Multi-Stage Inventory Control</a></h3>
<h3 id="multi-stage-stochastic-financial-planning"><a href="example_dro_finpl">Multi-Stage Stochastic Financial Planning</a></h3>

<h2 id="reference">Reference</h2>

<p><a id="ref1"></a></p>

<p>Bertsimas, Dimitris, Melvyn Sim, and Meilin Zhang. 2019. <a href="http://www.optimization-online.org/DB_FILE/2016/03/5353.pdf">Adaptive distributionally robust optimization</a>. <i>Management Science</i> <b>65</b>(2) 604-618.</p>

<p><a id="ref2"></a></p>

<p>Chen, Zhi, Melvyn Sim, Peng Xiong. 2020. <a href="https://pubsonline.informs.org/doi/abs/10.1287/mnsc.2020.3603">Robust stochastic optimization made easy with RSOME</a>. <i>Management Science</i> <b>66</b>(8) 3329–3339.</p>

<p><a id="ref3"></a></p>

<p>Wiesemann, Wolfram, Daniel Kuhn, Melvyn Sim. 2014. <a href="https://pubsonline.informs.org/doi/abs/10.1287/opre.2014.1314">Distributionally robust convex optimization</a>. <i>Operations Research</i> <b>62</b>(6) 1358–1376.</p>


      </section>
      <footer>
        
        <p>Maintained by <a href="https://github.com/XiongPengNUS">XiongPengNUS</a></p>
        
      </footer>
    </div>
    <script src="/assets/js/scale.fix.js"></script>


  
  </body>
</html>
